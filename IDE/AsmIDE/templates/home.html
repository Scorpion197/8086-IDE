{% load static %}
<!DOCTYPE html>
<html>
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="utf-8" lang="en">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/main.css' %}" type="text/css">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,300;0,800;1,100;1,300;1,400&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.gstatic.com">

</head>
<body>
    <form action="{% url 'send_test_page' %}" method="POST">
        {% csrf_token %}

        <input name='first-name' type="text" placeholder="First name" required>
        <input name='family-name' type="text" placeholder="Family name" required>
        <input name="email" type="email" placeholder="Email" required>
        <input name="group" type="number" placeholder="Group" required>
        <input name="test-id" type="number" placeholder="Test Id" required>
        <input name="test-passwd" type="password" placeholder="Test password" required>


        <div id="asm-code" name="content"></div>
        <input type="submit" value="submit"><br>

    </form> 

    {% if wrong_test_id %}
        <script>alert('Wrong test id ');</script>
    {% endif %}

    {% if wrong_password %}
        <script> alert('Wrong test password');</script>
    {% endif %}
    
    <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script src="{% static 'js/codemirror.js' %}"></script>
    <script src="{% static 'js/simple.js' %}"></script>
    <script>
        CodeMirror.defineSimpleMode('asm86',{
            start:[
            {regex: /"(?:[^\\]|\\.)*?(?:"|$)/, token: "string"},
            {regex: /'(?:[^\\]|\\.)*?(?:'|$)/, token: "string"},
                
                {regex: /REP[\t\s]+(MOVS|CMPS|SCAS|LODS|STOS)(b|w)\b/i, token: 'builtin'}, //instrcution

                {regex: /[\s\t]*(add|adc|inc|sub|sbb|dec|neg|cmp|mul|imul|div|idiv|cbw|cwd|not|mov|push|pop|xchg|pushf|popf|SHL|SAL|SHR|SAR|ROL|ROR|RCL|RCR|AND|OR|TEST|XOR|REP|(MOVS|CMPS|SCAS|LODS|STOS)(b|w)|CALL|JMP|RET|JE|JZ|JL|JNGE|JLE|JNG|JB|JNAE|JBE|JNA|JP|JPE|JO|JS|JNE|JNZ|JNL|JGE|JNLE|JG|JNB|JAE|JNBE|JA|JNP|JPO|JNO|JNS|LOOP|LOOPZ|LOOPE|LOOPNZ|LOOPNE|INT|CLC|CMC|STC|CLD|STD)\b/i, token: 'builtin', sol: true},                      //instrcution

                

                {regex: /[a-z][a-z0-9]*\s*\:/i, token: 'link', indent: true},    //label
                {regex: /[\s\t]*(org|endp|endm|proc)\b/i, token: 'tag', sol: true},
                {regex: /[\s\t]+(offset|macro|db|dw)\b/i, token: 'tag'},     //prep
                {regex: /,(offset|macro|db|dw)\b/i, token: 'tag'},     //prep

                {regex: /[\s\t]+(ax|bx|cx|dx|si|di|bp|sp)\b/i, token: 'def'},         //REG 16
                {regex: /[\s\t]+(al|bl|cl|dl|ah|bh|ch|dh)\b/i, token: 'def'},  //REG  8
                {regex: /[\s\t]+(cs|ds|es|ss)\b/i, token: 'property'},                //REG SEG

                {regex: /,(ax|bx|cx|dx|si|di|bp|sp)\b/i, token: 'def'},         //REG 16
                {regex: /,(al|bl|cl|dl|ah|bh|ch|dh)\b/i, token: 'def'},  //REG  8
                {regex: /,(cs|ds|es|ss)\b/i, token: 'property'},                //REG SEG

                {regex: /[\s\t]*(ax|bx|cx|dx|si|di|bp|sp)\b/i, token: 'def', sol:true},         //REG 16
                {regex: /[\s\t]*(al|bl|cl|dl|ah|bh|ch|dh)\b/i, token: 'def', sol:true},  //REG  8
                {regex: /[\s\t]*(cs|ds|es|ss)\b/i, token: 'property', sol:true},                //REG SEG
                
                {regex: /[-+\/*=<>![\]:]+/, token: "tag"},
                {regex: /;.*/, token: "comment"},

                {regex: /^(\s+|,|\b)(0x[0-9]+[0-9a-f]*h*|(0x)*[0-9]+[0-9a-f]*h|[0-9]+)\b/i, token: 'number'}   //NB
            ],


            meta: {
                lineComment: ";"
            }

        });

        var codeMirror = CodeMirror(document.getElementById('asm-code'), {
          value: '\norg 0h \n\nret\n',
          mode: 'asm86',
          theme: 'monokai',
          smartIndent: false,
          lineNumbers: true,
          indentWithTabs: true,

          readOnly: false
      });

    </script>
    
</body>
</html>